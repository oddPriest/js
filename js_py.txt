ä»¥ä¸‹ã«ã€http-server ã‚’ä½¿ã£ãŸ Node.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆé™çš„ã‚µã‚¤ãƒˆï¼‰ã¨ Django ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆREST APIï¼‰é€£æºã®é››å½¢ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç´¹ä»‹ã—ã¾ã™ã€‚http-server ã¯ã‚·ãƒ³ãƒ—ãƒ«ãªé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ã§ã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’å—ã‘å–ã‚Šã€JavaScript ã® fetch() çµŒç”±ã§ Django ã« API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹æ§‹æˆã§ã™ã€‚

â¸»

ğŸ”§ æ§‹æˆæ¦‚è¦

/frontend/       â† Node.js + http-server ã§ãƒ›ã‚¹ãƒˆï¼ˆHTML+JSï¼‰
/backend/        â† Djangoï¼ˆREST APIï¼‰


â¸»

ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆé››å½¢ï¼‰

attendance-app/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ submit.js
â”‚   â””â”€â”€ style.css
â””â”€â”€ backend/
    â””â”€â”€ [Django ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€å¼]


â¸»

ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆï¼ˆNode.js http-serverï¼‰

ğŸ”¹ 1. frontend/index.html

<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å‹¤æ€ è¨˜éŒ²</title>
  <script src="js/submit.js" defer></script>
</head>
<body>
  <h1>å‡ºå‹¤æ‰“åˆ»</h1>
  <form id="attendance-form">
    <label>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID:
      <input type="text" id="user-id" required>
    </label>
    <button type="submit">æ‰“åˆ»</button>
  </form>
  <p id="message"></p>
</body>
</html>


â¸»

ğŸ”¹ 2. frontend/js/submit.js

document.getElementById('attendance-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const userId = document.getElementById('user-id').value;
  const now = new Date().toISOString();

  try {
    const response = await fetch('http://localhost:8000/api/attendance/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        user: userId,
        clock_in: now
      })
    });

    const result = await response.json();
    document.getElementById('message').textContent = 'æ‰“åˆ»æˆåŠŸ: ' + JSON.stringify(result);
  } catch (err) {
    document.getElementById('message').textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼';
  }
});


â¸»

ğŸ”¹ 3. http-server ã§èµ·å‹•

# å¿…è¦ãªå ´åˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g http-server

# frontend ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œï¼ˆãƒãƒ¼ãƒˆã¯ä¾‹ï¼‰
http-server -p 3000

â†’ ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ Django ã«æ‰“åˆ»ã§ãã¾ã™ã€‚

â¸»

ğŸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆDjangoï¼‰

ğŸ”¹ Djangoå´ã®APIï¼ˆç°¡ç•¥ä¾‹ï¼‰

models.py

from django.db import models

class Attendance(models.Model):
    user = models.CharField(max_length=100)
    clock_in = models.DateTimeField()

serializers.py

from rest_framework import serializers
from .models import Attendance

class AttendanceSerializer(serializers.ModelSerializer):
    class Meta:
        model = Attendance
        fields = '__all__'

views.py

from rest_framework.decorators import api_view
from rest_framework.response import Response
from .serializers import AttendanceSerializer

@api_view(['POST'])
def attendance_create(request):
    serializer = AttendanceSerializer(data=request.data)
    if serializer.is_valid():
        serializer.save()
        return Response(serializer.data, status=201)
    return Response(serializer.errors, status=400)

urls.py

from django.urls import path
from .views import attendance_create

urlpatterns = [
    path('api/attendance/', attendance_create),
]


â¸»

âš ï¸ è£œè¶³
	â€¢	Django å´ã§ CORS å¯¾å¿œãŒå¿…è¦ã§ã™ã€‚ä»¥ä¸‹ã‚’ settings.py ã«è¿½åŠ ï¼š

pip install django-cors-headers

INSTALLED_APPS = [
    ...,
    'corsheaders',
    ...
]

MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',
    ...
]

CORS_ALLOW_ALL_ORIGINS = True  # â€»é–‹ç™ºä¸­ã®ã¿


â¸»

âœ… æœ€çµ‚ã‚¤ãƒ¡ãƒ¼ã‚¸
	â€¢	http-server ã«ã‚ˆã‚Š HTML + JS ãŒæä¾›ã•ã‚Œã€
	â€¢	JSãŒãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ Django API ã«POSTã€
	â€¢	DjangoãŒDBã«ä¿å­˜ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™

ã“ã®ã‚ˆã†ãªæ§‹æˆãªã‚‰ã€è»½é‡ã« Node.jsã®ç°¡æ˜“ãƒ•ãƒ­ãƒ³ãƒˆ + Djangoã®å¼·åŠ›ãªãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ã‚’ä¸¡ç«‹ã§ãã¾ã™ã€‚

â¸»

å¿…è¦ã§ã‚ã‚Œã°ã€å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆZipã‚„ã€æ‰“åˆ»è¨˜éŒ²ã®ä¸€è¦§è¡¨ç¤ºå¯¾å¿œã‚‚ã”æ¡ˆå†…ã§ãã¾ã™ã€‚ã©ã®ç¨‹åº¦ã®å®Œæˆåº¦ã¾ã§å¿…è¦ã‹æ•™ãˆã¦ãã ã•ã„ã€‚